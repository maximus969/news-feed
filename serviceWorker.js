"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_self=self,date=new Date,firstJan=new Date(date.getFullYear(),0,1),version=["v",date.getFullYear(),Math.floor((date.getTime()-firstJan.getTime())/6048e5)].join(),cacheKey="newsfeed_"+version;_self.addEventListener("install",(function(e){e.waitUntil(caches.open(cacheKey).then((function(e){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(t){return[2,e.addAll(["/","https://frontend.karpovcourses.net/api/v2/ru/trends/","https://frontend.karpovcourses.net/api/v2/ru/news/","https://frontend.karpovcourses.net/api/v2/ru/news/6"])]}))}))})).catch((function(e){return console.log("service worker intall error",e)})))})),_self.addEventListener("activate",(function(e){e.waitUntil(caches.keys().then((function(e){return Promise.all(e.filter((function(e){return e!==cacheKey})).map((function(e){return caches.delete(e)})))})))})),_self.addEventListener("fetch",(function(e){return __awaiter(void 0,void 0,void 0,(function(){var t;return __generator(this,(function(n){return(t=e.request.url).startsWith("http")&&"GET"===e.request.method.toUpperCase()&&e.respondWith(__awaiter(void 0,void 0,void 0,(function(){var n,r,a,o,i,s,c,u,l;return __generator(this,(function(f){switch(f.label){case 0:n=e.request,r=-1!==(null===(u=n.headers.get("Accept"))||void 0===u?void 0:u.indexOf("text/html"))&&t.startsWith(_self.origin),a=!r&&-1!==(null===(l=n.headers.get("Accept"))||void 0===l?void 0:l.indexOf("image/")),o=r?"/":n,f.label=1;case 1:return f.trys.push([1,7,,9]),a?[4,caches.match(o)]:[3,3];case 2:if(c=f.sent())return[2,c];f.label=3;case 3:return[4,fetch(o)];case 4:return i=f.sent(),[4,caches.open(cacheKey)];case 5:return[4,f.sent().put(o,i.clone())];case 6:return f.sent(),[2,i];case 7:return s=f.sent(),[4,caches.match(o)];case 8:return(c=f.sent())?[2,c]:(console.log(s),[3,9]);case 9:return[2,new Response("",{status:502,statusText:"No internet connection"})]}}))}))),[2]}))}))}));